<!doctype html>
<html>
<head>
<title>LiveScript</title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<link href="bootstrap/themes/cerulean.bootstrap.min.css" rel="stylesheet">
<link href="bootstrap/css/bootstrap-responsive.css" rel="stylesheet">

<script src="bootstrap/js/bootstrap.js"></script>
<script src="bootstrap/js/bootstrap-scrollspy.js"></script>

<link href="styles.less" rel="stylesheet/less" type="text/css">
<script src="less-1.3.0.min.js#!watch"></script>

</head>
<body data-spy="scroll">
<div class="site container-fluid">
  <div class="row-fluid side-row">
    <div class="span2 sidebar">
      <h1>LiveScript</h1>
      <ul class="nav nav-list">
        <li class=""><a href="#overview">Overview</a></li> 
        <li class=""><a href="#examples">Examples</a></li> 
      </ul>
    </div>
    <div class="span4 compiler">
      <div class="compiler-box">
        <textarea placeholder="Enter LiveScript here"></textarea>
        <div class="actions">
          <button class="btn btn-primary" data-action="compile" title="Convert LiveScript to JavaScript">Compile</button>
          <button class="btn" data-action="run" title="Run compiled JavaScript">Run</button>
          <button class="btn" data-action="ast" title="Abstract Syntax Tree">AST</button>
          <button class="btn" data-action="tokens" title="Tokenization of input">Tokens</button>
          <button class="btn" data-action="lex" title="Same as tokens, but skipping rewriting">Lex</button>
        </div>
      </div>
      <div class="compiler-output">

      </div>
    </div>
  </div>
  <div class="row-fluid content-row">
    <div class="span2">&nbsp;</div>
    <div class="span6 content">
      <a id="overview" name="overview"></a>
      <p class="well description">LiveScript is a fork of <a href="//satyr.github.com/coco/">Coco</a> which is in turn derived from <a href="//coffeescript.org/">CoffeeScript</a>. It is a language that compiles down to JavaScript. For more information please see the <a href="https://github.com/gkz/LiveScript/blob/master/README.md">README</a> and the <a href="https://github.com/gkz/LiveScript">github project</a>.</p>
      <a id="examples" name="examples"></a>
      <h2>Examples</h2>
      <p>Double-click the example LiveScript to load it into the compiler.
      <h3>Example 1</h3>
      <h4>LiveScript</h4>
<pre class="example">take(n, [x, ...xs]:list) =
  | n <= 0       => []
  | !list.length => []
  | otherwise    => x & take n - 1, xs

take 2, [1 2 3 4 5] #=> [1, 2]</pre>
      <h4>Compiled JavaScript</h4>
<pre>var take, __slice = [].slice;
take = function(n, list){
  var x, xs;
  x = list[0], xs = __slice.call(list, 1);
  switch (false) {
  case !(n <= 0):
    return [];
  case !!list.length:
    return [];
  default:
    return [(x)].concat(take(n - 1, xs));
  }
};
take(2, [1, 2, 3, 4, 5]); //=> [1, 2]</pre>
      <h3>Example 2</h3>
      <h4>LiveScript</h4>
<pre class="example">times = (x, y) --> x * y

timesTwo = times 2

timesTwo 4 #=> 8</pre>
      <h4>Compiled JavaScript</h4>
<pre>var times, timesTwo;
times = __curry(function(x, y){
  return x * y;
});
timesTwo = times(2);
timesTwo(4); //=> 8

function __curry(func) {
  var __slice = [].slice, f,
      args    = __slice.call(arguments, 1);
  if (!func.length) { return func; }
  f = function(){
    var params = args;
    !!arguments.length && (params = params.concat(__slice.call(arguments)));
    return params.length >= func.length ? 
      func.apply(this, params) : __curry.apply(this,[].concat(func, params));
  };
  return args.length >= func.length ? f() : f;
};</pre>

    </div>
  </div>
</div>

<script type="text/ls">
  console?.log 'LiveScript up'
  websafe = (txt) ->
     if "string" is typeof txt
        # works better than replace, though perhaps not as fast
        txt.split("&").join("&amp;").split("<").join("&lt;") 
     else 
        txt

  !boom(action) = 
    result = try 
      func = if action is \run then \compile else action
      LiveScript[func]($ '.compiler textarea' .val!, {+bare})
    catch e
      e.message
    if action is \run
      result = eval result
    if result
      console?.log result
      result = JSON.stringify result if action in <[ lex tokens ]>
      result = websafe result
      close = ' href="#close" class="closer" title="Close" '
      $ '.compiler-output'
        .prepend "<div><h3>#action<a #close >x</a></h3><pre>#result</pre></div>"

  $ '.compiler-output' .on \click \.closer ->
    $(this) .parent! .parent! .hide!   # or remove()
    return false

  $ '.actions button' .on \click ->
    boom($ @ .data \action)

  $ '.example' .on \dblclick ->
    $ '.compiler textarea' .val($ this .text!)

  $ '.sidebar .nav-list' .on \click \a ->
    $ '.sidebar .nav-list li' .removeClass \active
    $ this .parent \li .addClass \active

  $ '.sidebar .navlist' .scrollspy!

</script>
<script src="https://raw.github.com/gkz/LiveScript/master/extras/livescript.js" async=true ></script>
</body>
</html>
